<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Feet & Inches Calculator</title>
<style>
    * { box-sizing: border-box; margin:0; padding:0; }
    body {
        display: flex;
        justify-content: center;
        align-items: flex-start;
        min-height: 100vh;
        background: linear-gradient(135deg, #f5f7fa, #c3cfe2);
        font-family: "Segoe UI", sans-serif;
        padding: 10px;
    }

    .container {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 15px;
        width: 100%;
        max-width: 400px;
    }

    .calculator {
        width: 100%;
        background: #fff;
        border-radius: 20px;
        box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        display: flex;
        flex-direction: column;
        overflow: hidden;
    }

    .display {
        background: #f1f2f6;
        border: none;
        text-align: right;
        font-size: 2.5em;
        padding: 25px 20px;
        outline: none;
        color: #2d3436;
    }

    .buttons {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        grid-auto-rows: 80px;
        gap: 8px;
        padding: 8px;
    }

    button {
        font-size: 1.8em;
        border: 1px solid #dee2e6;
        background: #f8f9fa;
        color: #2d3436;
        cursor: pointer;
        border-radius: 12px;
        transition: 0.2s;
    }

    button:hover { transform: scale(1.05); }

    .clear { background: #ff7675; color: white; font-weight: bold; }
    .back { background: #74b9ff; color: white; }
    .percent { background: #fab1a0; color: #2d3436; }
    .operator { background: #55efc4; font-weight: bold; font-size: 2em; }
    .plus { grid-row: span 2; font-size: 2.2em; background: #55efc4; }
    .equal { grid-column: span 2; background: #ffa502; color: white; font-weight: bold; font-size: 2em; }

    /* History button */
    .history-toggle {
        background: #6c5ce7;
        color: white;
        padding: 10px 20px;
        border-radius: 15px;
        cursor: pointer;
        font-size: 1em;
        box-shadow: 0 4px 10px rgba(0,0,0,0.15);
    }

    /* Floating History panel */
    .history {
        position: fixed;
        right: 10px;
        top: 100px;
        width: 220px;
        max-height: 350px;
        background: #fff;
        border-radius: 15px;
        box-shadow: 0 6px 20px rgba(0,0,0,0.25);
        padding: 10px;
        overflow-y: auto;
        display: none; /* hidden by default */
        z-index: 1000;
    }

    .history h3 { text-align: center; margin-top: 0; border-bottom: 1px solid #dcdde1; padding-bottom: 5px; }
    .history-entry { font-size: 1em; padding: 6px; margin-bottom: 5px; border-radius: 6px; background: #f1f2f6; color: #2d3436; }

    @media (max-width: 450px) {
        .buttons { grid-auto-rows: 70px; gap: 6px; }
        button { font-size: 1.5em; }
        .display { font-size: 2em; padding: 20px; }
        .history { width: 180px; top: 80px; max-height: 300px; }
    }
</style>
</head>
<body>

<div class="container">
    <div class="calculator">
        <input type="text" id="display" class="display" readonly>

        <div class="buttons">
            <button class="clear" onclick="clearDisplay()">C</button>
            <button class="back" onclick="backspace()">⌫</button>
            <button class="percent" onclick="append('%')">%</button>
            <button class="operator" onclick="append('/')">÷</button>

            <button onclick="append('7')">7</button>
            <button onclick="append('8')">8</button>
            <button onclick="append('9')">9</button>
            <button class="operator" onclick="append('*')">×</button>

            <button onclick="append('4')">4</button>
            <button onclick="append('5')">5</button>
            <button onclick="append('6')">6</button>
            <button class="operator" onclick="append('-')">−</button>

            <button onclick="append('1')">1</button>
            <button onclick="append('2')">2</button>
            <button onclick="append('3')">3</button>
            <button class="plus" onclick="append('+')">+</button>

            <button onclick="append('0')">0</button>
            <button onclick="append('.')">.</button>
            <button class="equal" onclick="calculate()">=</button>
        </div>
    </div>

    <div class="history-toggle" onclick="toggleHistory()">History</div>
</div>

<div class="history" id="history">
    <h3>History</h3>
    <div id="historyList"></div>
</div>

<script>
const display = document.getElementById('display');
const historyList = document.getElementById('historyList');
const historyPanel = document.getElementById('history');

// Load history from localStorage
window.onload = function() {
    const savedHistory = JSON.parse(localStorage.getItem('calcHistory')) || [];
    savedHistory.forEach(entry => addToHistory(entry, false));
};

function append(value) { display.value += value; }
function clearDisplay() { display.value = ''; }
function backspace() { display.value = display.value.slice(0,-1); }

function calculate() {
    try {
        let expr = display.value;
        const tokens = expr.split(/([+\-*/])/).map(t=>t.trim());
        let totalInches = 0;
        let operator = '+';

        tokens.forEach(token=>{
            if(['+','-','*','/'].includes(token)) { operator = token; }
            else if(token){
                let [feet,inches] = token.split('.').map(Number);
                if(!inches) inches=0;
                let inchesTotal = feet*12 + inches;

                switch(operator){
                    case '+': totalInches += inchesTotal; break;
                    case '-': totalInches -= inchesTotal; break;
                    case '*': totalInches *= inchesTotal/12; break;
                    case '/': totalInches /= inchesTotal/12; break;
                }
            }
        });

        let feetResult = Math.floor(totalInches/12);
        let inchesResult = Math.round(totalInches%12);
        let displayResult = `${feetResult}.${inchesResult}`; // numeric for chaining
        let historyResult = `${feetResult}′ ${inchesResult}″`; // readable

        addToHistory(`${display.value} = ${historyResult}`, true);
        display.value = displayResult;

    } catch { display.value = "Error"; }
}

function addToHistory(entry, save){
    const div = document.createElement('div');
    div.className = 'history-entry';
    div.textContent = entry;
    historyList.prepend(div);

    if(save){
        let history = JSON.parse(localStorage.getItem('calcHistory')) || [];
        history.unshift(entry);
        if(history.length>20) history.pop();
        localStorage.setItem('calcHistory', JSON.stringify(history));
    }
}

function toggleHistory(){
    if(historyPanel.style.display==='none') historyPanel.style.display='block';
    else historyPanel.style.display='none';
}

// Keyboard support
document.addEventListener("keydown",(e)=>{
    const allowed = "0123456789.+-*/%";
    if(allowed.includes(e.key)) append(e.key);
    else if(e.key==="Enter") calculate();
    else if(e.key==="Backspace") backspace();
    else if(e.key==="Escape") clearDisplay();
});
</script>

</body>
</html>
